<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CNoto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;speedpromise.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:true,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;buttons&quot;,&quot;active&quot;:&quot;gitalk&quot;,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null,&quot;activeClass&quot;:&quot;gitalk&quot;},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:true}}</script><script src="/js/config.js"></script><meta name="description" content="本章我们会详细了解 HTTP 原理、爬虫的基本原理、Cookie的基本原理、多进程和多线程的基本原理等，有助于我们更好理解和编写网络爬虫程序。"><meta property="og:type" content="article"><meta property="og:title" content="爬虫笔记一 -- 爬虫基础"><meta property="og:url" content="https://speedpromise.github.io/archives/fc84b201.html"><meta property="og:site_name" content="Hyacinthの博客"><meta property="og:description" content="本章我们会详细了解 HTTP 原理、爬虫的基本原理、Cookie的基本原理、多进程和多线程的基本原理等，有助于我们更好理解和编写网络爬虫程序。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://s2.loli.net/2022/03/25/CVEnaLS48xYeWKA.png"><meta property="article:published_time" content="2022-02-14T08:26:50.000Z"><meta property="article:modified_time" content="2022-03-25T05:38:23.737Z"><meta property="article:author" content="Hyacinth"><meta property="article:tag" content="爬虫笔记"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2022/03/25/CVEnaLS48xYeWKA.png"><link rel="canonical" href="https://speedpromise.github.io/archives/fc84b201.html"><script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;speedpromise.github.io&#x2F;archives&#x2F;fc84b201.html&quot;,&quot;path&quot;:&quot;archives&#x2F;fc84b201.html&quot;,&quot;title&quot;:&quot;爬虫笔记一 -- 爬虫基础&quot;}</script><script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script><title>爬虫笔记一 -- 爬虫基础 | Hyacinthの博客</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Hyacinthの博客" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Hyacinthの博客</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">记录点滴日常</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">1.</span> <span class="nav-text">HTTP基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%AC%E8%99%AB%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">爬虫基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session-%E5%92%8C-Cookie"><span class="nav-number">3.</span> <span class="nav-text">Session 和 Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%A4%9A%E8%BF%9B%E7%A8%8B"><span class="nav-number">5.</span> <span class="nav-text">多线程和多进程</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Hyacinth" src="/images/rotate.gif"><p class="site-author-name" itemprop="name">Hyacinth</p><div class="site-description" itemprop="description">平常心 普通人</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">57</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/SpeedPromise" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;SpeedPromise" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:teemopro@163.com" title="E-Mail → mailto:teemopro@163.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div><canvas id="canvas" style="width:60%">当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>!function(){var o,a,r,f,t,i=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],e=document.getElementById("canvas");function h(t,e){for(var n=[1,2,3],l=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],o=0;o<i[e].length;o++)for(var a,h=0;h<i[e][o].length;h++)1==i[e][o][h]&&(a={x:14*(f+2)*t+2*h*(f+1)+(f+1),y:2*o*(f+1)+(f+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*n[Math.floor(Math.random()*n.length)],color:l[Math.floor(Math.random()*l.length)],disY:1},r.push(a))}function n(){e.height=100;for(var t=0;t<a.length;t++)!function(t,e){for(var n=0;n<i[e].length;n++)for(var l=0;l<i[e][n].length;l++)1==i[e][n][l]&&(o.beginPath(),o.arc(14*(f+2)*t+2*l*(f+1)+(f+1),2*n*(f+1)+(f+1),f,0,2*Math.PI),o.closePath(),o.fill())}(t,a[t]);for(t=0;t<r.length;t++)o.beginPath(),o.arc(r[t].x,r[t].y,f,0,2*Math.PI),o.fillStyle=r[t].color,o.closePath(),o.fill()}e.getContext&&(o=e.getContext("2d"),e.height=100,e.width=700,o.fillStyle="#f00",o.fillRect(10,10,50,50),a=[],r=[],f=e.height/20-1,t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),a.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6]),clearInterval(void 0),setInterval(function(){!function(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),n=[];n.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var l=a.length-1;0<=l;l--)n[l]!==a[l]&&t.push(l+"_"+(Number(a[l])+1)%10);for(l=0;l<t.length;l++)h.apply(this,t[l].split("_"));a=n.concat()}(),function(){for(var t=0;t<r.length;t++)r[t].stepY+=r[t].disY,r[t].x+=r[t].stepX,r[t].y+=r[t].stepY,(r[t].x>700+f||r[t].y>100+f)&&(r.splice(t,1),t--)}(),n()},50))}()</script><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/archives/23a0d725.html" title="Vue ToDo 项目实战(1)：环境搭建和项目分析" target="_blank">Vue ToDo 项目实战(1)：环境搭建和项目分析</a></li><li><a href="/archives/63270a97.html" title="Electron 安装失败：Electron failed to install correctly" target="_blank">Electron 安装失败：Electron failed to install correctly</a></li><li><a href="/archives/9679350.html" title="Webug 4.0 笔记" target="_blank">Webug 4.0 笔记</a></li><li><a href="/archives/ad504db1.html" title="爬虫笔记十 -- 模拟登录" target="_blank">爬虫笔记十 -- 模拟登录</a></li><li><a href="/archives/a900817c.html" title="爬虫笔记九 -- 代理池的搭建及实战应用" target="_blank">爬虫笔记九 -- 代理池的搭建及实战应用</a></li></ul></div><div id="music163player"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="52" src="//music.163.com/outchain/player?type=2&id=1808492017&auto=0&height=32"></iframe></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a href="https://github.com/SpeedPromise" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener external nofollow noreferrer" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://speedpromise.github.io/archives/fc84b201.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/rotate.gif"><meta itemprop="name" content="Hyacinth"><meta itemprop="description" content="平常心 普通人"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hyacinthの博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">爬虫笔记一 -- 爬虫基础</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-02-14 16:26:50" itemprop="dateCreated datePublished" datetime="2022-02-14T16:26:50+08:00">2022-02-14</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a> </span></span><span id="/archives/fc84b201.html" class="post-meta-item leancloud_visitors" data-flag-title="爬虫笔记一 -- 爬虫基础" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span></span></div><div class="post-meta"><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>8.8k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><img data-src="https://s2.loli.net/2022/03/25/CVEnaLS48xYeWKA.png"></p><p>本章我们会详细了解 HTTP 原理、爬虫的基本原理、Cookie的基本原理、多进程和多线程的基本原理等，有助于我们更好理解和编写网络爬虫程序。</p><span id="more"></span><h3 id="HTTP基本原理"><a href="#HTTP基本原理" class="headerlink" title="HTTP基本原理"></a>HTTP基本原理</h3><ol><li><strong>URI 和 URL</strong></li></ol><p>URI (Uniform Resource Identifier)，即统一资源标识符；URL (Uniform Resource Locator)，即统一资源定位符。用来寻找互联网上某个资源的链接就是 URI/URL，且具有唯一性。URL 是 URI 的子集，URI 还包括一个子类，叫做URN(Universal Resource Name)，即统一资源名称，只为资源命名而不指定定位，使用很少。对于一般网页链接，都称为 URI 或 URL（习惯）。</p><p>URL遵循一定格式规范，中括号部分为非必要部分，如下：</p><p><code>scheme://[username:password@]hostname[:port][/path][;parameters][?query][#fragment]</code></p><ul><li><code>scheme</code>:：协议。常用的有 http、https、ftp等，也称作 protocol</li><li><code>username</code>、password：用户名和密码。某些情况下 URL 需要提供用户名和密码才能访问</li><li><code>hostname</code>：主机地址。可以是域名或 IP 地址，如 <code>https://www.baidu.com</code>，<code>https://8.8.8.8</code></li><li><code>port</code>：端口。服务器设定的服务端口，如<code>https://8.8.8.8:1234</code>，有些 URL 没有端口信息，是使用默认端口，http 协议默认端口是 80，https 则是 443</li><li><code>path</code>：路径。指网络资源在服务器中的指定地址，如<code>https://github.com/favicon.ico</code>中的 favicon.ico</li><li><code>parameters</code>：参数。用来访问某个资源时的附加信息，如<code>https://8.8.8.8:1234/hello;user</code>，这和 query 不同，勿混用，parameters 是分号后内容</li><li><code>query</code>：查询。如果有多个查询，用 &amp; 隔开，如<code>https://www.example.com/s?wd=nba%ie=utf-8</code></li><li><code>fragment</code>：片段。是对资源描述的部分补充，可理解为资源内容的书签</li></ul><ol start="2"><li><strong>HTTP 和 HTTPS</strong></li></ol><p>在爬虫中，我们抓取的页面通常是基于 HTTP(Hypertext Transfer Protocol) 和 HTTPS(Hypertext Transfer Protocol over Secure Socket Layer) 协议的。</p><p>HTTPS 是在 HTTP 下加入 SSL 层，通过该协议传输的内容都是经过 SSL 加密的，SSL 主要作用如下：</p><ul><li>建立一个信息安全通道，保证数据传输的安全性</li><li>确认网站的真实性。凡是使用 HTTPS 协议的网站，可通过单机浏览器地址栏锁头标志来查看网站认证之后的真实信息，也可通过 CA 机构颁发的安全签章来查询</li></ul><ol start="3"><li><strong>HTTP 请求过程</strong></li></ol><p>在浏览器地址栏输入一个 URL，按下回车后便会向网站所在服务器发送一个请求，网站服务器接收到请求后对其进行处理和解析，然后返回对应响应并传回浏览器，响应中包含页面源代码等内容，浏览器对其进行解析呈现所需网页。</p><ol start="4"><li><strong>请求</strong></li></ol><p>Request，由浏览器发往服务器，分为四部分：请求方法（Request Method）、请求网址（Request URL）、请求头（Request Headers）、请求体（Request Body）。</p><ul><li>请求方法</li></ul><table><thead><tr><th align="center">方法</th><th align="center">描 述</th></tr></thead><tbody><tr><td align="center">GET *</td><td align="center">请求页面，返回页面内容</td></tr><tr><td align="center">HEAD</td><td align="center">类似于 GET 请求，但响应无内容，用于获取报头</td></tr><tr><td align="center">POST *</td><td align="center">大多用于提交表单或上传文件，数据包含在请求体中</td></tr><tr><td align="center">PUT</td><td align="center">用客户端传向服务器的数据替换指定文档中的内容（更新）</td></tr><tr><td align="center">DELETE</td><td align="center">请求服务器删除指定页面</td></tr><tr><td align="center">CONNECT</td><td align="center">把服务器当做跳板，让服务器代替客户端访问其他网页</td></tr><tr><td align="center">OPTIONS</td><td align="center">允许客户端查看服务器的性能</td></tr><tr><td align="center">TRACE</td><td align="center">回显服务器收到的请求，主要用于测试或诊断</td></tr></tbody></table><ul><li><p>请求网址<br>可唯一确定客户端需求资源。</p></li><li><p>请求头</p></li></ul><table><thead><tr><th align="center">请求头</th><th align="center">描 述</th></tr></thead><tbody><tr><td align="center">Accept</td><td align="center">请求报头域，用于指定客户端可接受哪些类型的信息</td></tr><tr><td align="center">Accept-Language</td><td align="center">用于指定客户端可接受的语言类型</td></tr><tr><td align="center">Accept-Encoding</td><td align="center">用于指定客户端可接受的内容编码</td></tr><tr><td align="center">Host</td><td align="center">用于指定请求资源的主机 IP 和端口号，内容为请求 URL 的原始服务器或网关位置</td></tr><tr><td align="center">Cookie</td><td align="center">也常用 Cookies，网站为了辨别用户，进行会话跟踪而存储在用户本地的数据。主要功能是维持当前访问会话</td></tr><tr><td align="center">Referer</td><td align="center">用于标识请求的来源页面，服务器可据此做相应处理，如来源统计、防盗链处理等</td></tr><tr><td align="center">User-Agent</td><td align="center">简称 UA，使服务器识别，客户端使用的操作系统及版本、浏览器及版本信息。爬取时加上使得伪装浏览器程度更高</td></tr><tr><td align="center">Content-Type</td><td align="center">也叫互联网媒体类型（Internet Media Type）或 MIME 类型，表示请求中的媒体类型信息</td></tr></tbody></table><ul><li>请求体<br>一般承载的的是 POST 请求中的表单数据，对于 GET 请求，请求头为空。</li></ul><table><thead><tr><th align="center">Content-Type</th><th align="center">POST 提交数据方式</th></tr></thead><tbody><tr><td align="center">application/x-www-form-urlencoded</td><td align="center">表单数据</td></tr><tr><td align="center">multipart/form-data</td><td align="center">表单文件上传</td></tr><tr><td align="center">application/json</td><td align="center">序列化 JSON 数据</td></tr><tr><td align="center">text/html</td><td align="center">XML 数据</td></tr></tbody></table><ol start="5"><li><strong>响应</strong></li></ol><p>Response，由服务器返回给客户端，分为三部分：响应状态码（Response Status Code）、响应头（Response Headers）和响应体（Response Body）。</p><ul><li>响应状态码&emsp;&emsp;&emsp;&emsp;&emsp;</li></ul><table><thead><tr><th align="center"><span style="display:inline-block;width:60px">状态码</span></th><th align="center">说明</th><th align="center">详 情</th></tr></thead><tbody><tr><td align="center">100</td><td align="center">Continue</td><td align="center">继续。客户端应继续其请求</td></tr><tr><td align="center">101</td><td align="center">Switching Protocols</td><td align="center">切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议</td></tr><tr><td align="center"><strong>200</strong></td><td align="center">OK</td><td align="center">请求成功。一般用于GET与POST请求</td></tr><tr><td align="center">201</td><td align="center">Created</td><td align="center">已创建。成功请求并创建了新的资源</td></tr><tr><td align="center">202</td><td align="center">Accepted</td><td align="center">已接受。已经接受请求，但未处理完成</td></tr><tr><td align="center">203</td><td align="center">Non-Authoritative Information</td><td align="center">非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本</td></tr><tr><td align="center">204</td><td align="center">No Content</td><td align="center">无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档</td></tr><tr><td align="center">205</td><td align="center">Reset Content</td><td align="center">重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域</td></tr><tr><td align="center">206</td><td align="center">Partial Content</td><td align="center">部分内容。服务器成功处理了部分GET请求</td></tr><tr><td align="center">300</td><td align="center">Multiple Choices</td><td align="center">多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择</td></tr><tr><td align="center">301</td><td align="center">Moved Permanently</td><td align="center">永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替</td></tr><tr><td align="center">302</td><td align="center">Found</td><td align="center">临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td></tr><tr><td align="center">303</td><td align="center">See Other</td><td align="center">查看其它地址。与301类似。使用GET和POST请求查看</td></tr><tr><td align="center">304</td><td align="center">Not Modified</td><td align="center">未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源</td></tr><tr><td align="center">305</td><td align="center">Use Proxy</td><td align="center">使用代理。所请求的资源必须通过代理访问</td></tr><tr><td align="center">306</td><td align="center">Unused</td><td align="center">已经被废弃的HTTP状态码</td></tr><tr><td align="center">307</td><td align="center">Temporary Redirect</td><td align="center">临时重定向。与302类似。使用GET请求重定向</td></tr><tr><td align="center">400</td><td align="center">Bad Request</td><td align="center">客户端请求的语法错误，服务器无法理解</td></tr><tr><td align="center">401</td><td align="center">Unauthorized</td><td align="center">请求要求用户的身份认证</td></tr><tr><td align="center">402</td><td align="center">Payment Required</td><td align="center">保留，将来使用</td></tr><tr><td align="center">403</td><td align="center">Forbidden</td><td align="center">服务器理解请求客户端的请求，但是拒绝执行此请求</td></tr><tr><td align="center">404</td><td align="center">Not Found</td><td align="center">服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置”您所请求的资源无法找到”的个性页面</td></tr><tr><td align="center">405</td><td align="center">Method Not Allowed</td><td align="center">客户端请求中的方法被禁止</td></tr><tr><td align="center">406</td><td align="center">Not Acceptable</td><td align="center">服务器无法根据客户端请求的内容特性完成请求</td></tr><tr><td align="center">407</td><td align="center">Proxy Authentication Required</td><td align="center">请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td></tr><tr><td align="center">408</td><td align="center">Request Time-out</td><td align="center">服务器等待客户端发送的请求时间过长，超时</td></tr><tr><td align="center">409</td><td align="center">Conflict</td><td align="center">服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突</td></tr><tr><td align="center">410</td><td align="center">Gone</td><td align="center">客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置</td></tr><tr><td align="center">411</td><td align="center">Length Required</td><td align="center">服务器无法处理客户端发送的不带Content-Length的请求信息</td></tr><tr><td align="center">412</td><td align="center">Precondition Failed</td><td align="center">客户端请求信息的先决条件错误</td></tr><tr><td align="center">413</td><td align="center">Request Entity Too Large</td><td align="center">由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息</td></tr><tr><td align="center">414</td><td align="center">Request-URI Too Large</td><td align="center">请求的URI过长（URI通常为网址），服务器无法处理</td></tr><tr><td align="center">415</td><td align="center">Unsupported Media Type</td><td align="center">服务器无法处理请求附带的媒体格式</td></tr><tr><td align="center">416</td><td align="center">Requested range not satisfiable</td><td align="center">客户端请求的范围无效</td></tr><tr><td align="center">417</td><td align="center">Expectation Failed</td><td align="center">服务器无法满足Expect的请求头信息</td></tr><tr><td align="center">500</td><td align="center">Internal Server Error</td><td align="center">服务器内部错误，无法完成请求</td></tr><tr><td align="center">501</td><td align="center">Not Implemented</td><td align="center">服务器不支持请求的功能，无法完成请求</td></tr><tr><td align="center">502</td><td align="center">Bad Gateway</td><td align="center">作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应</td></tr><tr><td align="center">503</td><td align="center">Service Unavailable</td><td align="center">由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中</td></tr><tr><td align="center">504</td><td align="center">Gateway Time-out</td><td align="center">充当网关或代理的服务器，未及时从远端服务器获取请求</td></tr><tr><td align="center">505</td><td align="center">HTTP Version not supported</td><td align="center">服务器不支持请求的HTTP协议的版本，无法完成处理</td></tr></tbody></table><ul><li>响应头</li></ul><table><thead><tr><th align="center">响应头</th><th align="center">描 述</th></tr></thead><tbody><tr><td align="center">Date</td><td align="center">用于标识响应产生的时间</td></tr><tr><td align="center">Last-Modified</td><td align="center">用于指定资源的最后修改时间</td></tr><tr><td align="center">Content-Encoding</td><td align="center">用于指定响应内容的编码</td></tr><tr><td align="center">Server</td><td align="center">包含服务器信息，如名称、版本号等</td></tr><tr><td align="center">Content-Type</td><td align="center">文档类型，指定返回数据类型</td></tr><tr><td align="center">Set-Cookie</td><td align="center">设置 Cookie，用于告诉浏览器需要将此内容放在 Cookie 中，下次请求时将 Cookie 带上</td></tr><tr><td align="center">Expires</td><td align="center">用于指定响应过期时间，可让代理服务器或浏览器将加载的内容更新到缓存中</td></tr></tbody></table><ul><li>响应体<br>响应正文数据都在响应体中，爬虫请求后要解析的就是响应体。在浏览器开发者工具中单机 Preview，可看到网页源代码。</li></ul><ol start="6"><li><strong>HTTP 2.0</strong></li></ol><p>HTTP 协议自 2015 年发布 2.0 版本，特点是更快、更简单、更稳定。HTTP 2.0 在传输层做了很多优化，主要目标是通过支持完整的请求与响应复用来减少延迟，并通过有效压缩 HTTP 请求头字段的方式将协议开销降到最低，同时增加对请求优先级和服务器推送的支持。另外，修改版本为 2.0 是因为 2.0 版本实现了二进制分帧层，无法与 HTTP 1.x 的服务器和客户端兼容。</p><ul><li>二进制分帧层<br>在 1.x 版本中，请求和响应都是用文本格式传输的，头部和实体间是用文本换行符隔开的，HTTP 2.0 则将文本格式改为二进制格式，使得解析更高效。同时将请求和响应数据分割为更小的帧，并采用二进制编码，将 HTTP 协议通信分解为二进制编码帧的交换，这些帧对应着特定数据流中的消息，所有这些都可以在一个 TCP 连接中复用。</li><li>多路复用<br>在 HTTP 1.x 中，如果客户端要发起多个并行请求以提升性能，需要使用多个 TCP 连接，而且浏览器为了控制资源，对单个域名会有 6~8 个 TCP 连接请求的限制。但在 HTTP 2.0 中，客户端和服务器可将 HTTP 消息分解为互不依赖的帧，然后交错发送，再在另一端将其重新组装，达到以下效果：<ul><li>并行交错地发送多个请求，请求之间互不影响</li><li>并行交错地发送多个响应，响应之间互不干扰</li><li>使用一个连接并行发送多个请求和响应</li><li>不必再为绕过 HTTP 1.x 限制而做很多工作</li><li>消除不必要的延迟和提高现有网络容量的利用率，减少页面加载时间</li><li>同域名只需占用一个 TCP 连接，并行发送多个请求和响应，消除多余的延时和内存消耗</li><li>每个请求可以带一个 31 位的优先值，0 表示最高优先级，数值越大优先级越低。据此，客户端和服务器可以在处理不同的流时采取不同的策略，以最优的方式发送流、消息和帧</li></ul></li><li>流控制<br>流控制是一种阻止发送方向接收方发送大量数据的机制，以免超出后者的需求或处理能力。HTTP 2.0 提供了一组简单的构建块，允许客户端和服务器实现它们自己的数据流和连接级流控制。<ul><li>流控制具有方向性。每个接收方都可根据自身需要选择为每个数据流和整个连接设置任意的窗口大小</li><li>流控制的窗口大小是动态调整的。每个接收方都可公布其初始连接和数据流控制窗口（字节单位），当发送放发出 DATA 帧时窗口减小，在接收方发出 WINDOW_UPDATE 帧时窗口增大</li><li>流控制无法停用。建立 HTTP 2.0 连接后，客户端与服务器交换 SETTINGS 帧，这会在两个方向上设置流控制窗口</li></ul></li><li>服务器推送<br>服务器可对一个客户端请求发送多个响应，除了对最初请求响应外，也可主动推送资源，无须客户端明确请求。</li><li>HTTP 2.0 发展现状<br>任重而道远，虽然一些主流网站和主流浏览器实现了对 HTTP 2.0 的支持，但总体上大部分网站仍以 HTTP 1.1 为主。另外，一些编程语言库还未完全支持 HTTP’ 2.0，对 Python 来说，hyper、httpx 等库已支持 2.0，但广泛使用的 request 库依然只支持 HTTP 1.1。</li></ul><h3 id="爬虫基本原理"><a href="#爬虫基本原理" class="headerlink" title="爬虫基本原理"></a>爬虫基本原理</h3><p>把互联网比作一张大网，爬虫（网络爬虫）便是在网上爬行的蜘蛛。把网中的节点比作一个个网页，蜘蛛爬到节点相当于爬虫访问了一个页面。节点间的连线可比作网页间的链接关系，蜘蛛通过一个节点后，顺着节点连线继续爬行到下一个节点，意味着爬虫通过网页间的链接关系继续获取后续网页，直至将整个网站涉及页面都访问到并存储获取到的数据。</p><p>爬虫就是获取网页并提取和保存信息的自动化程序。</p><h3 id="Session-和-Cookie"><a href="#Session-和-Cookie" class="headerlink" title="Session 和 Cookie"></a>Session 和 Cookie</h3><p>很多页面需要登录才可以访问，为了保持这种登录状态，就要用到 Session 和 Cookie。</p><p>HTTP 有一个特点，无状态。是指 HTTP 协议对事物处理是没有记忆能力的，服务器并不知道客户端处于什么状态，如果需要多次处理之前的消息，客户端就需要额外传递一些重复请求，才能获取后续响应。</p><p>Session，即会话，本义指有始有终的一系列动作、消息。如打电话时，从拿起电话拨号通话，到挂断电话之间的一系列过程可称为一个 Session。它位于服务端，用来保持用户的 Session 信息。当用户请求到来，如果还没对应 Session，则会新建。当 Session 过期或被放弃后，服务器会终止该 Session。</p><p>Cookie 在客户端，浏览器在下次访问相同网页时会自动带上，Cookie 中携带了 Session ID 信息，服务器通过识别 Cookie 鉴定出具体用户，然后判断是否处于登录状态，并返回对应响应。</p><p>Cookie 包含的内容如下：</p><table><thead><tr><th>条目</th><th align="center">描 述</th></tr></thead><tbody><tr><td>Name</td><td align="center">Cookie 名称，一经创建，不可更改</td></tr><tr><td>Value</td><td align="center">Cookie 值，若为 Unicode 字符，则需要为字符编码；若为二进制数据，则需要使用 BASE64 编码</td></tr><tr><td>Domain</td><td align="center">指定可以访问该 Cookie 的域名</td></tr><tr><td>Path</td><td align="center">Cookie 的使用路径。如 / 表示所有页面，/path/ 表示路径为 /path/ 的页面才能访问</td></tr><tr><td>Max-Age</td><td align="center">Cookie 的失效时间，单位秒，常和 Expires 一起使用，通过此属性可计算 Cookie 的有效时间。若为负数，Cookie 在浏览器关闭后失效</td></tr><tr><td>Size</td><td align="center">Cookie 的大小</td></tr><tr><td>HTTP</td><td align="center">Cookie 的 httponly 属性。若为 true，则只有在 HTTP Headers中才会带有此 Cookie 的信息，不能通过 document.cookie 访问此 Cookie</td></tr><tr><td>Secure</td><td align="center">是否仅允许使用安全协议传输 Cookie。使用安全协议在传输数据前会先加密，默认为 false</td></tr></tbody></table><p><strong>tips</strong></p><p>除非程序通知服务器删除一个 Session，否则服务器会一直保留。当浏览器关闭后 Cookie 就消失的情况，等再次打开连接服务器，新 Cookie 无法连接到原先的 Session。如果将 Cookie 保存到硬盘上，或使用某种手段改写浏览器发出的 HTTP 请求头，把原来的 Cookie 发给服务器，则又能保持登录状态。</p><h3 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h3><p>网站会采取一些反爬虫措施，如检测某个 IP 在单位时间内的请求次数，如果请求次数超过设定阈值，会拒绝响应请求，并返回一些错误信息，这种情况称为封 IP。一种有效的伪装 IP 的方式就是使用代理。</p><ol><li><strong>基本原理</strong></li></ol><p>代理是发挥着网络信息中转站的作用，当客户端发起请求时，先由代理服务器接收，再由代理服务器发给 Web 服务器，返回的响应也是先由代理服务器接收，再发给客户端。如此，Web 服务器便无法识别真实 IP。</p><ol start="2"><li><strong>代理作用</strong></li></ol><ul><li>突破自身 IP 的访问限制，访问一些平时不能访问的站点</li><li>访问一些单位和团体的内部资源，如使用教育网内地址段的免费代理服务器，就可以下载和上传对教育网开放的各类 FTP，也可以查询、共享各类资料等</li><li>提高访问速度。通常，代理服务器会设置一个较大的硬盘缓冲区，当外界信息通过时，会保存到缓冲区中，当其他用户访问相同信息时，直接从缓冲区取出信息，提高访问速度</li><li>隐藏真实 IP。上网者可以隐藏自己的 IP，免受攻击或防止被封锁</li></ul><ol start="3"><li><strong>代理分类</strong></li></ol><p>根据<strong>协议</strong>区分：</p><ul><li>FTP 代理服务器：主要用于访问 FTP 服务器，一般有上传、下载以及缓存功能，端口一般为 21、2121等</li><li>HTTP 代理服务器：主要用于访问网页，一般有内容过滤和缓存功能，端口一般为 80、8080、3128等</li><li>SSL/TLS 代理：主要用于访问加密网站，一般有 SSL 或 TLS 加密功能（最高支持 128 位），端口一般为 443</li><li>RTSP 代理：主要用于 Realplayer 访问 Real 流媒体服务器，一般有缓存功能，端口一般为 554</li><li>Telnet 代理：主要用于 Telnet 远程控制（黑客入侵计算机时常用于隐藏身份），端口一般为 23</li><li>POP3/SMTP 代理：主要用于以 POP3/SMTP 方式收发邮件，一般有缓存功能，端口一般为 110/25</li><li>SOCKS 代理：单纯传递数据包，不关心具体协议和用法，所以速度快很多，一般有缓存功能，端口一般为 1080。SOCKS 代理协议又分为 SOCKS4 和 SOCKS5，SOCKS4 只支持 TCP，后者则支持 TCP 和 UDP，还支持各种身份验证机制、服务器端域名解析等</li></ul><p>根据<strong>匿名程序</strong>区分</p><ul><li>高度匿名代理：会将数据包原封不动地转发</li><li>普通匿名代理：会对数据包对一些改动，服务器可能会发现访问的是代理服务器，并有一定概率去追查真实 IP。这里代理服务器通常会加入的 HTTP 头有 HTTP_VIA 和 HTTP_X_FORWARDED_FOR</li><li>透明代理：不但改动了数据包，还告诉服务器客户端的真实 IP。这种代理主要利用缓存技术提高访问速度，用内容过滤提高安全性，如内网中的硬件防火墙</li><li>间谍代理：由阻止或个人创建的代理服务器，用于记录用户传输的数据，然后对记录的数据进行研究、监控等</li></ul><ol start="4"><li><strong>常见代理设置</strong></li></ol><h3 id="多线程和多进程"><a href="#多线程和多进程" class="headerlink" title="多线程和多进程"></a>多线程和多进程</h3><ol><li><strong>多线程含义</strong></li></ol><p>进程是线程的集合，进程是由一个或多个线程构成的，线程是操作系统进行运算调度的最小单位，是进程中的最小运行单元。如在一个浏览器中，播放音乐是一个线程，播放视频也是一个线程，这些线程并发或并行执行使得浏览器可以同时运行多个任务。</p><ol start="2"><li><strong>并发与执行</strong></li></ol><p>处理器同一时间只能执行一条指令。并发（concurrency）是指多个线程对应的多条指令被快速轮换执行，从宏观上看起来是同时运行的，但同一时刻只有一个线程被执行。</p><p>并行（parallel）是指同一时刻有多条指令在多个处理器上同时执行，意味着并行必须依赖多个处理器。</p><ol start="3"><li><strong>多线程适用场景</strong></li></ol><p>在一个程序的进程中，有些操作是比较耗时的，如等待数据库查询结果的返回、等待网页的响应。处理器在等待过程中，是可以使用多线程去执行其他操作的。</p><p>网络爬虫就是一个典型例子，爬虫向服务器发起请求后，有一段时间需要等待服务器响应，这属于 IO 密集型任务，对于这种任务，使用多线程就可以提高整体爬取效率。</p><ol start="4"><li><strong>多进程含义</strong></li></ol><p>进程（progress）是具有一定独立功能的程序在某个数据集合上的一次运行活动，是系统进行资源分配和调度的一个独立单位。多进程就是指同时运行多个进程。</p><ol start="5"><li><strong>Python 中的多线程和多进程</strong></li></ol><p>Python 中 GIL(Global Interpreter Lock，全局解释锁) 的限制导致不论是在单核还是多核条件下，同一时刻只能运行一个线程，使得 Python 多线程无法发挥多核并行优势。</p><p>GIL设计之初是出于对数据安全的考虑，Python 多线程下，每个线程执行方式如下：</p><ul><li>获取 GIL</li><li>执行对应线程代码</li><li>释放 GIL</li></ul><p>GIL 就好像一个通行证，一个 Python 进程中，只有一个 GIL，线程只有拿到通行证才能执行，也就是说多进程能更好发挥多核优势。</p><p>对于爬虫这种 IO 密集型任务来说，多线程和多进程产生影响差别不大，但对于计算密集型任务来说，由于 GIL 的存在，Python 多线程的整体运行效率在多核情况下可能反而比单核还低。而 Python 多进程相比多线程，运行效率在多核情况下比单核会有成倍提升。</p><p>整体来看，Python 多进程比多线程更有优势。另外，由于进程是系统进行资源分配和调度的一个独立单位，所以各进程间的数据是不共享的，进程之间的数据须有单独的机制来实现。</p></div><div class="popular-posts-header">推荐阅读</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="\archives\ad504db1.html" rel="bookmark">爬虫笔记十 -- 模拟登录</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\archives\a900817c.html" rel="bookmark">爬虫笔记九 -- 代理池的搭建及实战应用</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\archives\410e6558.html" rel="bookmark">爬虫笔记八 -- 验证码的识别</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\archives\d1c41f0f.html" rel="bookmark">爬虫笔记七 -- JavaScript 动态渲染页面爬取</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\archives\57744bfb.html" rel="bookmark">爬虫笔记六 -- 异步爬虫</a></div></li></ul><footer class="post-footer"><div class="reward-container"><div>Buy me a coffee</div><button onclick='document.querySelector(".post-reward").classList.toggle("active")'>赞赏</button><div class="post-reward"><div><img src="/images/wechat-pay.png" alt="Hyacinth 微信"> <span>微信</span></div><div><img src="/images/alipay-pay.png" alt="Hyacinth 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>Hyacinth</li><li><strong>修改时间：</strong> <time title="修改时间：2022-03-25 13:38:23" itemprop="dateModified" datetime="2022-03-25T13:38:23+08:00">上周五13:38</time></li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://speedpromise.github.io/archives/fc84b201.html" title="爬虫笔记一 -- 爬虫基础">https://speedpromise.github.io/archives/fc84b201.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><span>欢迎关注我的其它发布渠道</span><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/images/wechat-qcode.jpg"><span class="icon"><i class="fab fa-weixin"></i> </span><span class="label">WeChat</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div></div></div><div class="post-tags"><a href="/tags/%E7%88%AC%E8%99%AB%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 爬虫笔记</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/fb40efc5.html" rel="prev" title="拓扑排序"><i class="fa fa-chevron-left"></i> 拓扑排序</a></div><div class="post-nav-item"><a href="/archives/50c99347.html" rel="next" title="爬虫笔记二 -- 基本库的使用">爬虫笔记二 -- 基本库的使用 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Hyacinth</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>站点总字数：</span> <span title="站点总字数">293k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>站点阅读时长 &asymp;</span> <span title="站点阅读时长">4:26</span></span></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>// 代码折叠<script src="/js/code-unfold.js"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="leancloud_visitors" type="application/json">{&quot;enable&quot;:true,&quot;app_id&quot;:&quot;mXCXRvyDJTe1MizGNz8MBQCC-MdYXbMMI&quot;,&quot;app_key&quot;:&quot;NKjSKtz16WlOVxKDRa1tJNgl&quot;,&quot;server_url&quot;:null,&quot;security&quot;:false}</script><script src="/js/third-party/statistics/lean-analytics.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script><script src="/js/third-party/math/mathjax.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"64px",right:"unset",left:"32px",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌓",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{&quot;enable&quot;:true,&quot;github_id&quot;:&quot;SpeedPromise&quot;,&quot;repo&quot;:&quot;blog-comments&quot;,&quot;client_id&quot;:&quot;c87c14d15109ca258c8c&quot;,&quot;client_secret&quot;:&quot;fcb23a076c153b6a22f7dc957f54510992dc0342&quot;,&quot;admin_user&quot;:&quot;SpeedPromise&quot;,&quot;distraction_free_mode&quot;:true,&quot;proxy&quot;:&quot;https:&#x2F;&#x2F;cors-anywhere.azm.workers.dev&#x2F;https:&#x2F;&#x2F;github.com&#x2F;login&#x2F;oauth&#x2F;access_token&quot;,&quot;language&quot;:null,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1.7.2&#x2F;dist&#x2F;gitalk.min.js&quot;,&quot;integrity&quot;:&quot;sha256-Pmj85ojLaPOWwRtlMJwmezB&#x2F;Qg8BzvJp5eTzvXaYAfA&#x3D;&quot;},&quot;path_md5&quot;:&quot;5539aa1f204e0403bf30ebd4805d1b77&quot;}</script><script src="/js/third-party/comments/gitalk.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script async src="/js/cursor/fireworks.js"></script></body></html>